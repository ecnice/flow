var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,n=(t,r,o)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[r]=o,l=(e,t,r)=>new Promise(((o,a)=>{var i=e=>{try{l(r.next(e))}catch(t){a(t)}},n=e=>{try{l(r.throw(e))}catch(t){a(t)}},l=e=>e.done?o(e.value):Promise.resolve(e.value).then(i,n);l((r=r.apply(e,t)).next())}));import{B as s,a as d}from"./index.98d9f37c.js";import{_ as c}from"./BasicForm.f3cb7023.js";import{u as m}from"./useForm.c6cb6ef5.js";import{af as p,b5 as u,y as f,r as g,u as h,j as b,Z as y,B as w,F as v,a2 as x,v as I,a0 as P}from"./vendor.880b4c6c.js";/* empty css              */import{c as j,s as S}from"./category.bb6c61bb.js";import{g as O}from"./company.eec3ae4b.js";const F=[{title:"名称",dataIndex:"name",align:"left"},{title:"编码",dataIndex:"code",width:100,align:"left"},{title:"简称",dataIndex:"shortName",width:100,align:"left"},{title:"所属公司",dataIndex:"cName",width:100,align:"left"},{title:"前台显示",dataIndex:"frontShow",width:80,customRender:({record:e})=>{const t=1==~~e.frontShow,r=t?"显示":"隐藏";return p(u,{color:t?"green":"red"},(()=>r))}},{title:"排序",dataIndex:"orderNo",width:80},{title:"创建时间",dataIndex:"createTime",width:180},{title:"描述",dataIndex:"note",align:"left"}],N=[{field:"keyword",label:"关键字",component:"Input",componentProps:{placeholder:"请输入名称/编码"},labelWidth:60,colProps:{span:6,lg:{span:6,offset:0},sm:{span:10,offset:0},xs:{span:16,offset:0}}}],q=[{field:"id",label:"ID",component:"Input",show:!1},{field:"pid",label:"pid",required:!1,component:"Input",show:!1},{field:"name",label:"名称",required:!0,component:"Input",rules:[{required:!0,whitespace:!0,message:"名称不能为空！"},{max:200,message:"字符长度不能大于200！"}]},{field:"code",label:"编码",required:!0,component:"Input"},{field:"shortName",label:"简称",required:!1,component:"Input",rules:[{whitespace:!0,message:"编码不能为空！"},{max:200,message:"字符长度不能大于200！"}]},{field:"companyId",label:"所属公司",component:"TreeSelect",componentProps:{treeNodeFilterProp:"cname",replaceFields:{title:"cname",key:"id",value:"id"},getPopupContainer:()=>document.body},required:!0},{field:"orderNo",label:"排序号",required:!1,component:"InputNumber"},{field:"frontShow",label:"状态",required:!1,component:"Switch",defaultValue:!0,componentProps:{checkedChildren:"显示",unCheckedChildren:"隐藏"}},{field:"note",label:"描述",required:!1,component:"InputTextArea",rules:[{max:400,message:"字符长度不能大于400！"}]}];var _=f({name:"CategoryModal",components:{BasicModal:s,BasicForm:c},emits:["success","register"],setup(e,{emit:s}){const c=g(!0),[p,{resetFields:u,updateSchema:f,setFieldsValue:y,validate:w}]=m({labelWidth:100,schemas:q,showActionButtonGroup:!1}),[v,{setModalProps:x,closeModal:I}]=d((e=>l(this,null,(function*(){yield u(),x({confirmLoading:!1}),c.value=!!(null==e?void 0:e.isUpdate);const l=yield O();f([{field:"companyId",componentProps:{treeData:l}}]);let s=e.record;var d,m;yield f([{field:"code",dynamicRules:()=>{return[{required:!0,whitespace:!0,message:"编码不能为空！"},{pattern:new RegExp("^[a-zA-Z_]{1,}[0-9a-zA-Z_]{1,}$"),type:"string",message:"请输入英文或数字且以英文或下划线开头！"},{max:30,message:"字符长度不能大于30！"},...(e={id:h(c)&&s&&s.id||"",field:"code",fieldValue:"",fieldName:"编码"},[{trigger:"blur",validator:(t,r)=>r?j({id:e.id,field:e.field,fieldValue:r,fieldName:e.fieldName}).then((t=>t?Promise.resolve():Promise.reject(e.fieldName+"已存在，请修改！"))).catch((e=>Promise.reject(e))):Promise.resolve()}])];var e}}]),h(c)&&y((d=((e,t)=>{for(var r in t||(t={}))a.call(t,r)&&n(e,r,t[r]);if(o)for(var r of o(t))i.call(t,r)&&n(e,r,t[r]);return e})({},s),m={frontShow:1===s.frontShow},t(d,r(m))))}))));return{registerModal:v,registerForm:p,getTitle:b((()=>h(c)?"修改":"新增")),handleSubmit:function(){return l(this,null,(function*(){try{x({confirmLoading:!0});const e=yield w();e.frontShow=e.frontShow?1:0,yield S(e),I(),s("success")}finally{x({confirmLoading:!1})}}))}}}});_.render=function(e,t,r,o,a,i){const n=y("BasicForm"),l=y("BasicModal");return w(),v(l,P(e.$attrs,{onRegister:e.registerModal,title:e.getTitle,onOk:e.handleSubmit}),{default:x((()=>[I(n,{onRegister:e.registerForm},null,8,["onRegister"])])),_:1},16,["onRegister","title","onOk"])};var B=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:_});export{B as C,_,F as c,N as s};
