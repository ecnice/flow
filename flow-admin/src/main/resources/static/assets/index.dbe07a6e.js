var w=(s,c,o)=>new Promise((l,a)=>{var u=n=>{try{r(o.next(n))}catch(i){a(i)}},d=n=>{try{r(o.throw(n))}catch(i){a(i)}},r=n=>n.done?l(n.value):Promise.resolve(n.value).then(u,d);r((o=o.apply(s,c)).next())});import{B as R,a as E}from"./index.30115123.js";import{B as M}from"./TableImg.73863b69.js";import{T as F}from"./BasicForm.6afa01de.js";import{u as W}from"./useTable.7c1e4a10.js";import{g as N}from"./personal.0950d6f5.js";import{P as O}from"./index.77f474a0.js";import L from"./OrgTree.6f2892b5.js";import{z as $,ba as S,A,r as T,j as D,a0 as m,B as g,a1 as C,a6 as b,H as z,D as V,ap as H,ae as K,J,ab as q,w as j,a4 as G}from"./vendor.7bee64cc.js";/* empty css               */import{_ as Q}from"./index.9eb02b52.js";import"./useWindowSizeFn.30e15ddc.js";/* empty css                *//* empty css              */import"./useForm.1fd322f5.js";/* empty css                *//* empty css                */import"./uuid.2b29000c.js";/* empty css               */import"./useSortable.dd731734.js";/* empty css                *//* empty css                *//* empty css               *//* empty css               */import"./index.1445cecb.js";/* empty css                *//* empty css                *//* empty css                */import"./download.78bd314d.js";import"./base64Conver.bb012c73.js";import"./index.83641cbd.js";/* empty css                *//* empty css                */import"./useContentViewHeight.52836077.js";import"./Tree.vue_vue&type=style&index=0&lang.43e63f89.js";import"./useContextMenu.e899090d.js";import"./dept.5a8fb534.js";const U=[{title:"\u59D3\u540D",dataIndex:"name",width:80,align:"left"},{title:"\u5DE5\u53F7",dataIndex:"code",width:80,align:"left"},{title:"\u6027\u522B",dataIndex:"sex",width:50,customRender:({record:s})=>{const o=~~s.sex==1,l=o?"green":"red",a=o?"\u7537":"\u5973";return $(S,{color:l},()=>a)}},{title:"\u516C\u53F8",dataIndex:"companyName",width:120,align:"left"},{title:"\u90E8\u95E8",dataIndex:"deptName",width:120,align:"left"}],_=[{field:"keyword",label:"\u5173\u952E\u5B57",component:"Input",labelWidth:60,colProps:{span:12,lg:{span:12,offset:0},sm:{span:10,offset:0},xs:{span:16,offset:0}},componentProps:{}}];const X=A({props:{title:{type:String,default:"\u4EBA\u5458\u9009\u62E9"}},name:"PersonalSelector",components:{BasicModal:R,BasicTable:M,PageWrapper:O,OrgTree:L,TableAction:F,Tag:S},setup(s,{emit:c}){const o=T([]),l=T(!1),[a,{setModalProps:u,closeModal:d}]=E(t=>w(this,null,function*(){const{selectorProps:e}=t;console.log(e.selectedList),o.value=e.selectedList,l.value=e.multiSelect,p(o.value.map(P=>P.code)),i({rowSelection:{type:e.multiSelect?"checkbox":"radio",columnWidth:30}}),u({wrapClassName:"selector-content"}),n()}));_.forEach(t=>{t&&(t.componentProps.onkeypress=e=>{e.keyCode===13&&n()})});const[r,{reload:n,setProps:i,getSelectRows:f,setSelectedRowKeys:p}]=W({title:"",api:N,columns:U,immediate:!1,rowSelection:{type:"checkbox",columnWidth:30},formConfig:{labelWidth:60,schemas:_,showResetButton:!1,showAdvancedButton:!1,autoSubmitOnEnter:!0},clickToRowSelect:!0,rowKey:"code",size:"small",canResize:!1,useSearchForm:!0,showTableSetting:!1,showIndexColumn:!1,bordered:!0,scroll:{y:280}}),h=D(()=>"\u9009\u62E9\u4EBA\u5458");function v(){n()}function y(t){o.value.splice(o.value.findIndex(e=>e.code===t),1),p(o.value.map(e=>e.code))}function x({rows:t}){o.value=t.map(e=>({id:e.id,code:e.code,name:e.name}))}function B(){x({rows:f()})}function k(){const t=f();c("success",t),d()}function I(t){let e={};t&&t.sourceType==="1"?e={companyId:t.id}:t&&t.sourceType==="2"&&(e={deptId:t.id}),n({searchInfo:e})}return{registerTable:r,registerModal:a,getTitle:h,selectedList:o,removeSelectedItem:y,rowClick:B,selectionChanged:x,handleSubmit:k,handleSuccess:v,handleSelect:I}}}),Y={class:"selected-items"};function Z(s,c,o,l,a,u){const d=m("Tag"),r=m("OrgTree"),n=m("BasicTable"),i=m("PageWrapper"),f=m("BasicModal");return g(),C(f,G({wrapClassName:"selector-body"},s.$attrs,{onRegister:s.registerModal,title:s.getTitle,onOk:s.handleSubmit}),{default:b(()=>[z("div",Y,[(g(!0),V(q,null,H(s.selectedList,p=>(g(),C(d,{color:"processing",closable:"",onClose:h=>s.removeSelectedItem(p.code)},{default:b(()=>[K(J(p.name),1)]),_:2},1032,["onClose"]))),256))]),j(i,{dense:"",contentClass:"flex"},{default:b(()=>[j(r,{class:"w-1/4 xl:w-3/10",onSelect:s.handleSelect},null,8,["onSelect"]),j(n,{onRegister:s.registerTable,onSelectionChange:s.selectionChanged,onRowClick:s.rowClick,class:"w-3/4 xl:w-7/10"},null,8,["onRegister","onSelectionChange","onRowClick"])]),_:1})]),_:1},16,["onRegister","title","onOk"])}var Oe=Q(X,[["render",Z]]);export{Oe as default};
