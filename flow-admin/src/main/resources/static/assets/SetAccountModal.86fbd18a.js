var A=Object.defineProperty,C=Object.defineProperties;var y=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var B=(o,s,e)=>s in o?A(o,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[s]=e,x=(o,s)=>{for(var e in s||(s={}))L.call(s,e)&&B(o,e,s[e]);if(b)for(var e of b(s))O.call(s,e)&&B(o,e,s[e]);return o},F=(o,s)=>C(o,y(s));var j=(o,s,e)=>new Promise((c,d)=>{var l=t=>{try{n(e.next(t))}catch(i){d(i)}},p=t=>{try{n(e.throw(t))}catch(i){d(i)}},n=t=>t.done?c(t.value):Promise.resolve(t.value).then(l,p);n((e=e.apply(o,s)).next())});import{B as U,a as $}from"./index.c505e96f.js";import{B as k}from"./BasicForm.0ba2e15f.js";import{u as R}from"./useForm.696aa965.js";import{a as D}from"./group.data.28418bb0.js";import{e as G}from"./account.1f18251a.js";import{b as I}from"./group.52de35d8.js";import{A as N,bD as P,r as v,u as h,j as T,a0 as g,B as V,a1 as W,a6 as _,w as M,a4 as z}from"./vendor.5879c5ca.js";import{_ as q}from"./index.e84e956c.js";import"./useWindowSizeFn.6a6adedd.js";/* empty css               *//* empty css               *//* empty css               *//* empty css                *//* empty css              *//* empty css               *//* empty css                *//* empty css                */import"./index.8b70aabd.js";/* empty css                *//* empty css                *//* empty css                *//* empty css                */import"./uuid.2b29000c.js";import"./download.e6dbd100.js";import"./base64Conver.bb012c73.js";import"./index.e83a4b09.js";const H=N({name:"SetAccountModal",components:{BasicModal:U,BasicForm:k,Select:P},emits:["success","register"],setup(o,{emit:s}){const e=v(!0),c=v([]),[d,{setFieldsValue:l,updateSchema:p,resetFields:n,validate:t}]=R({labelWidth:100,schemas:D,showActionButtonGroup:!1,actionColOptions:{span:23}}),[i,{setModalProps:u,closeModal:f}]=$(r=>j(this,null,function*(){n(),u({confirmLoading:!1,title:"\u7ED9\u7EC4\u3010"+r.record.name+"("+r.record.sn+")\u3011\u5206\u914D\u7528\u6237"}),e.value=!!(r==null?void 0:r.isUpdate);const m=yield G();if(m.forEach(a=>{a.label=a.realName+"("+a.username+")",a.value=a.id}),c.value=m,h(e)){let a=r.record.users||[];a=a.map(E=>E.id),l(F(x({},r.record),{users:a}))}}));let S=T(()=>h(e)?"\u4FEE\u6539":"\u65B0\u589E");function w(){return j(this,null,function*(){try{u({confirmLoading:!0});const r=yield t();console.log(r),r.users=r.users.map(m=>({id:m})),r.groupId=r.id,delete r.id,yield I(r),f(),s("success")}finally{u({confirmLoading:!1})}})}return{registerModal:i,registerForm:d,getTitle:S,accountOptions:c,handleSubmit:w}}});function J(o,s,e,c,d,l){const p=g("Select"),n=g("BasicForm"),t=g("BasicModal");return V(),W(t,z(o.$attrs,{onRegister:o.registerModal,title:o.getTitle,onOk:o.handleSubmit}),{default:_(()=>[M(n,{onRegister:o.registerForm},{users:_(({model:i,field:u})=>[M(p,{value:i[u],"onUpdate:value":f=>i[u]=f,mode:"multiple",style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u7528\u6237","option-label-prop":"label",options:o.accountOptions},null,8,["value","onUpdate:value","options"])]),_:1},8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}var he=q(H,[["render",J]]);export{he as default};
